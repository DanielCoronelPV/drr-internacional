@inject TranslationService Translator
@inject HttpClient Http
@implements IDisposable

<select class="language-select" @onchange="ChangeLanguage">
    <option value="es" selected="@("es" == Translator.CurrentLanguage)">Español</option>
    <option value="pt-BR" selected="@("pt-BR" == Translator.CurrentLanguage)">Português</option>
    <option value="zh-CN" selected="@("zh-CN" == Translator.CurrentLanguage)">中文 (Mandarín)</option>
</select>

@code {
    protected override void OnInitialized()
    {
        Translator.OnLanguageChanged += OnLanguageChangedHandler;
    }

    private async Task ChangeLanguage(ChangeEventArgs e)
    {
        var selectedLang = e.Value?.ToString() ?? "es";
        await Translator.SetLanguageAsync(Http, selectedLang);
    }

    private void OnLanguageChangedHandler()
    {
        InvokeAsync(StateHasChanged);
    }

    public void Dispose()
    {
        Translator.OnLanguageChanged -= OnLanguageChangedHandler;
    }
}
